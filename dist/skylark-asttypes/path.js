/**
 * skylark-asttypes - A version of asttypes that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./types"],function(t){"use strict";var e=Object.prototype.hasOwnProperty;return function(r){var n=r.use(t),a=n.builtInTypes.array,i=n.builtInTypes.number;const h=function t(e,r,n){if(!(this instanceof t))throw new Error("Path constructor cannot be invoked without 'new'");if(r){if(!(r instanceof t))throw new Error("")}else r=null,n=null;this.value=e,this.parentPath=r,this.name=n,this.__childCache=null};var l=h.prototype;function s(t){return t.__childCache||(t.__childCache=Object.create(null))}function u(t,r){var n=s(t),a=t.getValueProperty(r),i=n[r];return e.call(n,r)&&i.value===a||(i=n[r]=new t.constructor(a,t,r)),i}function o(){}function c(t,r,n,h){if(a.assert(t.value),0===r)return o;var l=t.value.length;if(l<1)return o;var u=arguments.length;2===u?(n=0,h=l):3===u?(n=Math.max(n,0),h=l):(n=Math.max(n,0),h=Math.min(h,l)),i.assert(n),i.assert(h);for(var c=Object.create(null),f=s(t),v=n;v<h;++v)if(e.call(t.value,v)){var p=t.get(v);if(p.name!==v)throw new Error("");var w=v+r;p.name=w,c[w]=p,delete f[v]}return delete f.length,function(){for(var e in c){var r=c[e];if(r.name!==+e)throw new Error("");f[e]=r,t.value[e]=r.value}}}return l.getValueProperty=function(t){return this.value[t]},l.get=function(...t){for(var e=this,r=t.length,n=0;n<r;++n)e=u(e,t[n]);return e},l.each=function(t,r){var n=[],a=this.value.length,i=0;for(i=0;i<a;++i)e.call(this.value,i)&&(n[i]=this.get(i));for(r=r||this,i=0;i<a;++i)e.call(n,i)&&t.call(r,n[i])},l.map=function(t,e){var r=[];return this.each(function(e){r.push(t.call(this,e))},e),r},l.filter=function(t,e){var r=[];return this.each(function(e){t.call(this,e)&&r.push(e)},e),r},l.shift=function(){var t=c(this,-1),e=this.value.shift();return t(),e},l.unshift=function(...t){var e=c(this,t.length),r=this.value.unshift.apply(this.value,t);return e(),r},l.push=function(...t){return a.assert(this.value),delete s(this).length,this.value.push.apply(this.value,t)},l.pop=function(){a.assert(this.value);var t=s(this);return delete t[this.value.length-1],delete t.length,this.value.pop()},l.insertAt=function(t){var e=arguments.length,r=c(this,e-1,t);if(r===o&&e<=1)return this;t=Math.max(t,0);for(var n=1;n<e;++n)this.value[t+n-1]=arguments[n];return r(),this},l.insertBefore=function(...t){for(var e=this.parentPath,r=t.length,n=[this.name],a=0;a<r;++a)n.push(t[a]);return e.insertAt.apply(e,n)},l.insertAfter=function(...t){for(var e=this.parentPath,r=t.length,n=[this.name+1],a=0;a<r;++a)n.push(t[a]);return e.insertAt.apply(e,n)},l.replace=function(t){var e=[],r=this.parentPath.value,n=s(this.parentPath),i=arguments.length;if(function(t){if(!(t instanceof h))throw new Error("");var e=t.parentPath;if(!e)return t;var r=e.value,n=s(e);if(r[t.name]===t.value)n[t.name]=t;else if(a.check(r)){var i=r.indexOf(t.value);i>=0&&(n[t.name=i]=t)}else r[t.name]=t.value,n[t.name]=t;if(r[t.name]!==t.value)throw new Error("");if(t.parentPath.get(t.name)!==t)throw new Error("")}(this),a.check(r)){for(var l=r.length,u=c(this.parentPath,i-1,this.name+1),o=[this.name,1],f=0;f<i;++f)o.push(arguments[f]);if(r.splice.apply(r,o)[0]!==this.value)throw new Error("");if(r.length!==l-1+i)throw new Error("");if(u(),0===i)delete this.value,delete n[this.name],this.__childCache=null;else{if(r[this.name]!==t)throw new Error("");for(this.value!==t&&(this.value=t,this.__childCache=null),f=0;f<i;++f)e.push(this.parentPath.get(this.name+f));if(e[0]!==this)throw new Error("")}}else if(1===i)this.value!==t&&(this.__childCache=null),this.value=r[this.name]=t,e.push(this);else{if(0!==i)throw new Error("Could not replace path");delete r[this.name],delete this.value,this.__childCache=null}return e},h}});
//# sourceMappingURL=sourcemaps/path.js.map
